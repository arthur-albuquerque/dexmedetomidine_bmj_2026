<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dexmedetomidine Evidence Atlas</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=Source+Serif+4:wght@500;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['\\(', '\\)'], ['$', '$']],
          displayMath: [['\\[', '\\]']],
          processEscapes: true
        }
      };
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <main class="page">
      <header class="hero" aria-label="Review header">
        <div class="hero-main">
          <div class="hero-topline">
            <p class="kicker">Clinical Evidence Dashboard</p>
            <button id="theme-toggle" class="theme-btn" type="button" aria-label="Toggle dark mode">Dark mode</button>
          </div>
          <h1>Dexmedetomidine Dosing and Timing in Postoperative Delirium Prevention</h1>
          <p class="subtitle">
            Designed for rapid clinical interpretation of how dexmedetomidine was administered across eligible trials.
          </p>
          <p class="scope-pill">Included comparisons: Dexmedetomidine versus placebo or saline</p>
          <p class="scope-pill">Outcome considered: Delirium incidence</p>
          <p class="citation">
            Source review: <em>Effectiveness of drug interventions to prevent delirium after surgery for older adults: systematic review and network meta-analysis of randomised controlled trials</em>.<br />
            Luney et al., 2026. DOI: 10.1136/bmj-2025-085539
            (<a href="https://www.bmj.com/content/392/bmj-2025-085539" target="_blank" rel="noopener noreferrer">BMJ article page</a>)
          </p>
        </div>

        <div class="hero-stats" aria-label="Summary statistics">
          <article class="stat-card">
            <span id="trials-total" class="stat-value">-</span>
            <span class="stat-label">Filtered Trials</span>
          </article>
          <article class="stat-card accent-pre">
            <span id="trials-pre" class="stat-value">-</span>
            <span class="stat-label">Pre-operatively</span>
          </article>
          <article class="stat-card accent-intra">
            <span id="trials-intra" class="stat-value">-</span>
            <span class="stat-label">Intra-operatively</span>
          </article>
          <article class="stat-card accent-post">
            <span id="trials-post" class="stat-value">-</span>
            <span class="stat-label">Post-operatively</span>
          </article>
          <article class="stat-card context-card">
            <span id="participants-total" class="stat-value">-</span>
            <span class="stat-label">Participants</span>
          </article>
        </div>
      </header>

      <nav class="top-tabs" aria-label="App views">
        <button id="tab-overview" class="top-tab is-active" type="button" data-tab="overview">
          Studies Overview
        </button>
        <button id="tab-analysis" class="top-tab" type="button" data-tab="analysis">
          Statistical Analysis
        </button>
      </nav>

      <section class="panel intro-panel" aria-label="Interpretation guidance">
        <h2>How to Read This Page</h2>
        <p>
          The charts display <strong>number of trials</strong>. Use timing filters to isolate when dexmedetomidine was given:
          <strong>Pre-operatively</strong>, <strong>Intra-operatively</strong>, or <strong>Post-operatively</strong>.
        </p>
      </section>

      <section class="panel" id="filters-panel" aria-label="Filters">
        <div class="panel-head">
          <h2>Filter Trials</h2>
          <button id="reset-filters" class="secondary-btn" type="button">Clear all filters</button>
        </div>
        <p class="filter-note">You can select multiple categories in each filter.</p>

        <div class="filters-grid">
          <div class="filter-field">
            <span class="filter-label">Risk of Bias (overall)</span>
            <details class="filter-popover" id="rob-filter">
              <summary class="popover-trigger">All risk categories</summary>
              <div class="popover-menu"></div>
            </details>
          </div>

          <div class="filter-field">
            <span class="filter-label">Timing of intervention</span>
            <details class="filter-popover" id="timing-filter">
              <summary class="popover-trigger">All timing categories</summary>
              <div class="popover-menu"></div>
            </details>
          </div>

          <div class="filter-field">
            <span class="filter-label">Route</span>
            <details class="filter-popover" id="route-filter">
              <summary class="popover-trigger">All routes</summary>
              <div class="popover-menu"></div>
            </details>
          </div>

          <div class="filter-field">
            <span class="filter-label">Infusion dose band</span>
            <details class="filter-popover" id="dose-filter">
              <summary class="popover-trigger">All dose bands</summary>
              <div class="popover-menu"></div>
            </details>
          </div>
        </div>
      </section>

      <section class="panel chart-grid" aria-label="Dose and timing charts">
        <article>
          <h2>Infusion Dose Bands</h2>
          <div id="dose-chart" class="chart"></div>
        </article>

        <article>
          <h2>Timing of Dexmedetomidine Administration</h2>
          <div id="timing-chart" class="chart"></div>
        </article>
      </section>

      <section
        class="panel meta-analysis-panel tab-analysis-only"
        id="meta-analysis-panel"
        aria-label="Statistical analysis"
      >
        <h2>Bayesian Meta-Analysis</h2>
        <p class="meta-note">
          Dots depict the median Observed OR. Purple curves depict study-specific shrinkage marginal posterior distributions. Vertical lines show the pooled median and 95% CrI limits. Credible intervals (CrI) are reported as highest-density intervals.
        </p>
        <div id="meta-forest" class="meta-forest-wrap"></div>
        <p class="meta-note">
          This panel reuses one Bayesian model fitted on the full eligible dataset. Filters update which trial rows are displayed in the forest plot, while the pooled effect remains the same full-dataset estimate.
        </p>
        <div id="meta-coverage-note" class="meta-coverage-note" role="status" aria-live="polite"></div>
        <details class="meta-explainer">
          <summary>Explanation about the Bayesian model</summary>
          <div class="meta-explainer-body">
            <p>
              We adapted Model 4 from Jackson et al.:
              <a href="https://onlinelibrary.wiley.com/doi/10.1002/sim.7588" target="_blank" rel="noopener noreferrer">
                A comparison of seven random-effects models for meta-analyses that estimate the summary odds ratio
              </a>
              (DOI: 10.1002/sim.7588).
            </p>
            <p>Model structure:</p>
            <p class="meta-equation">
              \[
              \begin{aligned}
              y_{ij}\sim \mathrm{Binomial}(n_{ij}, p_{ij}), \\
              \mathrm{logit}(p_{ij})=\gamma_i + \theta\,t_{ij} + u_i\,z_{ij}
              \end{aligned}
              \]
            </p>
            <p class="meta-equation">
              \[
              z_{ij}=t_{ij}-0.5,\qquad u_i\sim\mathcal{N}(0,\tau^2),\qquad
              \log(\mathrm{OR}_i)=\theta + u_i
              \]
            </p>
            <p>We fitted this in the Bayesian R package <a href="https://paulbuerkner.com/brms/" target="_blank" rel="noopener noreferrer"><code>brms</code></a> using the binomial likelihood with:</p>
            <pre><code>events | trials(total) ~ 0 + study + treat + (treat12 - 1 | study)</code></pre>
            <ul>
              <li><code>study</code>: fixed study-specific baseline log-odds (\(\gamma_i\)).</li>
              <li><code>treat</code>: treatment indicator (0 = control, 1 = dexmedetomidine), with pooled log-OR (\(\theta\)).</li>
              <li><code>treat12</code>: centered treatment coding (\(treat - 0.5\)), so control = \(-0.5\), dexmedetomidine = \(+0.5\).</li>
              <li><code>(treat12 - 1 | study)</code>: study-level random treatment deviation (\(u_i\)), with SD \(\tau\).</li>
            </ul>
            <p>Priors used in the fitted model:</p>
            <p class="meta-equation">
              \[
              b_{\text{study}}\sim\mathcal{N}(0,1.5^2),\qquad
              b_{\text{treat1}}\sim\mathcal{N}(0,0.82^2),\qquad
              \tau\sim\mathrm{Log\text{-}Normal}(-1.855,\,0.87^2)
              \]
            </p>
            <p>
              For heterogeneity, we used
              <code>bayesmeta::TurnerEtAlPrior(outcome = "cause-specific mortality / major morbidity event / composite (mortality or morbidity)", comparator1 = "pharmacological", comparator2 = "placebo / control")</code>
              from Turner et al. (2015):
              <a href="https://onlinelibrary.wiley.com/doi/10.1002/sim.6381" target="_blank" rel="noopener noreferrer">
                Predictive distributions for between-study heterogeneity and simple methods for their application in Bayesian meta-analysis
              </a>
              (DOI: 10.1002/sim.6381).
            </p>
            <p>
              Shrinkage study-specific effects are computed from posterior draws as
              \(\mathrm{OR}_i=\exp(\theta+u_i)\) and summarized with median and 95% CrI.
              Observed OR values are unshrunken two-by-two estimates from <code>metafor::escalc(measure = "OR")</code>,
              shown as point estimate and Wald 95% CI.
            </p>
          </div>
        </details>
      </section>

      <section class="panel" aria-label="Trial table">
        <h2>Trial-Level Details</h2>
        <p class="filter-note">You can select multiple categories in each table filter.</p>

        <div class="table-filters-grid">
          <div class="filter-field">
            <span class="filter-label">Study</span>
            <details class="filter-popover" id="tbl-filter-study">
              <summary class="popover-trigger">All studies</summary>
              <div class="popover-menu"></div>
            </details>
          </div>
          <div class="filter-field">
            <span class="filter-label">Country</span>
            <details class="filter-popover" id="tbl-filter-country">
              <summary class="popover-trigger">All countries</summary>
              <div class="popover-menu"></div>
            </details>
          </div>
          <div class="filter-field">
            <span class="filter-label">Risk of Bias</span>
            <details class="filter-popover" id="tbl-filter-rob">
              <summary class="popover-trigger">All risk categories</summary>
              <div class="popover-menu"></div>
            </details>
          </div>
          <div class="filter-field">
            <span class="filter-label">Bolus</span>
            <details class="filter-popover" id="tbl-filter-bolus">
              <summary class="popover-trigger">All bolus values</summary>
              <div class="popover-menu"></div>
            </details>
          </div>
          <div class="filter-field">
            <span class="filter-label">Infusion</span>
            <details class="filter-popover" id="tbl-filter-infusion">
              <summary class="popover-trigger">All infusion values</summary>
              <div class="popover-menu"></div>
            </details>
          </div>
          <div class="filter-field">
            <span class="filter-label">Timing</span>
            <details class="filter-popover" id="tbl-filter-timing">
              <summary class="popover-trigger">All timing categories</summary>
              <div class="popover-menu"></div>
            </details>
          </div>
          <div class="filter-field">
            <span class="filter-label">Route</span>
            <details class="filter-popover" id="tbl-filter-route">
              <summary class="popover-trigger">All routes</summary>
              <div class="popover-menu"></div>
            </details>
          </div>
        </div>

        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Study</th>
                <th>Country</th>
                <th>Risk of Bias</th>
                <th>Bolus</th>
                <th>Infusion</th>
                <th>Timing of intervention</th>
                <th>Route</th>
              </tr>
            </thead>
            <tbody id="trials-body"></tbody>
          </table>
        </div>
      </section>

      <footer class="app-footer" aria-label="App attribution">
        <p>
          This app was built by
          <a href="https://bsky.app/profile/aalbuquerque.bsky.social" target="_blank" rel="noopener noreferrer">Arthur M. Albuquerque, MD</a>,
          using GPT-5.3-Codex.
        </p>
        <p class="source-line">
          Source code:
          <a
            class="source-link"
            href="https://github.com/arthur-albuquerque/dexmedetomidine_bmj_2026"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="View source code on GitHub"
          >
            <svg class="github-icon" viewBox="0 0 16 16" aria-hidden="true" focusable="false">
              <path
                fill="currentColor"
                d="M8 0C3.58 0 0 3.58 0 8a8 8 0 0 0 5.47 7.59c.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49C3.78 14.2 3.31 12.73 3.31 12.73c-.36-.92-.88-1.16-.88-1.16-.72-.5.06-.49.06-.49.79.06 1.21.82 1.21.82.71 1.2 1.87.86 2.33.66.07-.52.28-.86.5-1.06-1.78-.2-3.64-.89-3.64-3.95 0-.88.31-1.59.82-2.16-.08-.2-.36-1.02.08-2.12 0 0 .67-.22 2.2.82A7.5 7.5 0 0 1 8 3.8c.68 0 1.37.09 2.01.26 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.57.82 1.28.82 2.16 0 3.07-1.87 3.75-3.65 3.95.29.25.54.74.54 1.49 0 1.08-.01 1.95-.01 2.21 0 .21.14.46.55.38A8 8 0 0 0 16 8c0-4.42-3.58-8-8-8Z"
              />
            </svg>
          </a>
        </p>
      </footer>
    </main>

    <script type="module" src="./app.js?v=20260214-20"></script>
  </body>
</html>
